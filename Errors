def create_report(results, output_filepath):
    doc = fitz.open()
    page = doc.new_page()
    page.insert_text((40, 20), "AGENDA COMPARISON REPORT", fontsize=16)

    y = 60
    max_width = 510  # Width of text box
    left_margin = 40
    right_margin = left_margin + max_width
    line_height = 14

    for label, status in results:
        text = f"{label}: {status}"

        # Wrap text manually using textwrap
        wrapped_text = "\n".join(textwrap.wrap(text, width=90))

        # Estimate needed height
        needed_height = wrapped_text.count("\n") * line_height + 10
        if y + needed_height > 760:
            page = doc.new_page()
            y = 40

        rect = fitz.Rect(left_margin, y, right_margin, y + needed_height)
        page.insert_textbox(rect, wrapped_text, fontsize=11)  # removed 'wrap' argument
        y += needed_height + 10

    doc.save(output_filepath)
    doc.close()